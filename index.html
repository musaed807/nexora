<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>NEXORA</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0b0f1a">

<style>
:root{
  --bg:#0b0f1a;
  --card:#111a33;
  --accent:#6cf2c2;
  --accent2:#6aa9ff;
  --text:#e9eeff;
}
*{box-sizing:border-box;font-family:system-ui}
body{
  margin:0;color:var(--text);
  background:radial-gradient(800px 400px at 80% -10%,#1b2a6a,transparent),
             radial-gradient(600px 300px at -10% 10%,#0f3b2c,transparent),
             var(--bg);
}
.hidden{display:none}
.center{min-height:100vh;display:flex;align-items:center;justify-content:center}
.card{
  width:min(420px,95vw);
  background:linear-gradient(180deg,#141e3a,#0f1730);
  border:1px solid #22306a;border-radius:18px;
  padding:22px;box-shadow:0 20px 50px rgba(0,0,0,.45)
}
input{
  width:100%;padding:12px;border-radius:12px;
  border:1px solid #22306a;background:#0e183a;color:var(--text);
  margin-bottom:10px
}
button{
  width:100%;padding:12px;border-radius:12px;
  border:none;font-weight:800;cursor:pointer
}
.primary{
  background:linear-gradient(90deg,var(--accent),var(--accent2));
  color:#04140c
}
.link{background:none;color:var(--accent);margin-top:8px}

/* APP */
header{
  display:flex;justify-content:space-between;align-items:center;
  padding:14px 18px;border-bottom:1px solid #22306a
}
.logo{font-weight:900}
.badge{padding:6px 10px;border-radius:999px;background:#0f1a3a}
main{padding:20px;display:grid;grid-template-columns:1fr 1fr;gap:16px}
.panel{
  background:linear-gradient(180deg,#141e3a,#0f1730);
  border:1px solid #22306a;border-radius:16px;padding:16px
}
.points{font-size:34px;font-weight:900;color:var(--accent)}
.games{display:grid;grid-template-columns:repeat(6,1fr);gap:10px}
.game{
  padding:10px;border-radius:12px;text-align:center;
  background:#0f1a3a;border:1px solid #22306a;font-size:13px
}
ol{padding-right:18px}
li{margin-bottom:6px}
@media(max-width:900px){main{grid-template-columns:1fr}}

/* SIN JEEM */
.overlay{
  position:fixed;inset:0;background:rgba(5,10,30,.85);
  display:none;align-items:center;justify-content:center
}
.modal{
  width:min(520px,95vw);
  background:linear-gradient(180deg,#16235a,#0f1b45);
  border:1px solid #2a3d8a;border-radius:18px;padding:18px
}
.answer{
  padding:10px;border-radius:12px;border:1px solid #2a3d8a;
  background:#0f1b45;margin-bottom:8px;cursor:pointer
}
.timer{height:6px;background:#1a2a6a;border-radius:999px;overflow:hidden;margin:10px 0}
.bar{height:100%;width:100%;background:linear-gradient(90deg,var(--accent),var(--accent2))}
</style>
</head>
<body>

<!-- LOGIN -->
<div class="center" id="auth">
  <div class="card">
    <h1>âš¡ NEXORA</h1>

    <div id="login">
      <input id="loginUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
      <input id="loginPass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
      <button class="primary" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
      <button class="link" onclick="toggle()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
    </div>

    <div id="register" class="hidden">
      <input id="regUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
      <input id="regPass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
      <button class="primary" onclick="register()">ØªØ³Ø¬ÙŠÙ„</button>
      <button class="link" onclick="toggle()">Ù„Ø¯ÙŠ Ø­Ø³Ø§Ø¨</button>
    </div>
  </div>
</div>

<!-- APP -->
<div id="app" class="hidden">
<header>
  <div class="logo">NEXORA</div>
  <div>ğŸ‘¤ <span id="user"></span></div>
  <div class="badge">Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="points">0</span></div>
  <button onclick="logout()">Ø®Ø±ÙˆØ¬</button>
</header>

<main>
  <div class="panel">
    <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨</h2>
    <div class="points" id="bigPoints">0</div>
    <button class="primary" onclick="openSJ()">Ø§Ø¨Ø¯Ø£ Ø³ÙŠÙ† Ø¬ÙŠÙ… ğŸ”¥</button>
  </div>

  <div class="panel">
    <h2>ğŸ† Leaderboard Ø¹Ø§Ù„Ù…ÙŠ</h2>
    <ol id="leaderboard"></ol>
  </div>

  <div class="panel">
    <h2>Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ (54)</h2>
    <div class="games" id="games"></div>
  </div>
</main>
</div>

<!-- SIN JEEM -->
<div class="overlay" id="sj">
  <div class="modal">
    <h2>ğŸ§  Ø³ÙŠÙ† Ø¬ÙŠÙ…</h2>
    <div class="timer"><div class="bar" id="bar"></div></div>
    <div id="q"></div>
    <div id="answers"></div>
    <button class="link" onclick="closeSJ()">Ø¥ØºÙ„Ø§Ù‚</button>
  </div>
</div>

<script>
// ======== Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ========
function users(){return JSON.parse(localStorage.getItem('users')||'{}')}
function save(u){localStorage.setItem('users',JSON.stringify(u))}

// ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨
function toggle(){
  const loginDiv = document.getElementById('login');
  const registerDiv = document.getElementById('register');
  loginDiv.classList.toggle('hidden');
  registerDiv.classList.toggle('hidden');
}

// ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
function register(){
  const u=document.getElementById('regUser').value.trim();
  const p=document.getElementById('regPass').value.trim();

  if(u==='' || p===''){
    alert('Ù„Ø§Ø²Ù… ØªØ¯Ø®Ù„ Ø§Ø³Ù… ÙˆÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±');
    return;
  }

  let us = users();
  if(us[u]){
    alert('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³ØªØ®Ø¯Ù…');
    return;
  }

  us[u] = { pass: p, points: 0 };
  save(us);

  alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ âœ…');
  toggle();
}

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
function login(){
  const u=document.getElementById('loginUser').value.trim();
  const p=document.getElementById('loginPass').value.trim();

  const us = users();
  if(!us[u] || us[u].pass!==p){
    alert('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø·Ø£');
    return;
  }

  localStorage.setItem('session', u);
  load();
}

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
function logout(){
  localStorage.removeItem('session');
  location.reload();
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„
function load(){
  const u = localStorage.getItem('session');
  if(!u) return;
  document.getElementById('auth').classList.add('hidden');
  document.getElementById('app').classList.remove('hidden');
  document.getElementById('user').textContent = u;
  const us = users();
  document.getElementById('points').textContent = us[u].points;
  document.getElementById('bigPoints').textContent = us[u].points;
  updateLeaderboard();
}
load();

// ======== Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ ========
const gamesDiv = document.getElementById('games');
for(let i=1;i<=54;i++){
  const d=document.createElement('div');
  d.className='game';
  d.textContent=i===1?'Ø³ÙŠÙ† Ø¬ÙŠÙ…':'Ù„Ø¹Ø¨Ø© '+i;
  if(i===1) d.onclick=openSJ;
  gamesDiv.appendChild(d);
}

// ======== Leaderboard ========
function updateLeaderboard(){
  const lb = document.getElementById('leaderboard');
  lb.innerHTML='';
  Object.entries(users())
    .sort((a,b)=>b[1].points - a[1].points)
    .slice(0,10)
    .forEach(([name,data])=>{
      const li = document.createElement('li');
      li.textContent = `${name} â€” ${data.points}`;
      lb.appendChild(li);
    });
}

// ======== Ø³ÙŠÙ† Ø¬ÙŠÙ… ========
const qs=[
 {q:'Ø¹Ø§ØµÙ…Ø© Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ØŸ',a:['Ø·ÙˆÙƒÙŠÙˆ','Ø£ÙˆØ³Ø§ÙƒØ§','ÙƒÙŠÙˆØªÙˆ'],c:0},
 {q:'ÙƒÙ… ÙƒÙˆÙƒØ¨ ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø´Ù…Ø³ÙŠØ©ØŸ',a:['7','8','9'],c:1}
];
let t;
function openSJ(){document.getElementById('sj').style.display='flex';nextQ()}
function closeSJ(){document.getElementById('sj').style.display='none';clearInterval(t)}
function nextQ(){
  const q=qs[Math.floor(Math.random()*qs.length)];
  document.getElementById('q').textContent=q.q;
  const answersDiv = document.getElementById('answers');
  answersDiv.innerHTML='';
  q.a.forEach((x,i)=>{
    const b = document.createElement('div');
    b.className='answer';
    b.textContent = x;
    b.onclick = ()=>{if(i===q.c){addPoint();} nextQ();}
    answersDiv.appendChild(b);
  });
  let w=100;
  const bar = document.getElementById('bar');
  bar.style.width='100%';
  clearInterval(t);
  t = setInterval(()=>{w-=2;bar.style.width=w+'%'; if(w<=0) nextQ()},100);
}

// Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø·Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
function addPoint(){
  const u=localStorage.getItem('session');
  const us = users();
  us[u].points++;
  save(us);
  document.getElementById('points').textContent = us[u].points;
  document.getElementById('bigPoints').textContent = us[u].points;
  updateLeaderboard();
}

// ======== Service Worker ========
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>
